{"version":3,"sources":["../src/index.ts"],"sourcesContent":["import { elizaLogger } from \"@ai16z/eliza\";\r\nimport {\r\n    Action,\r\n    HandlerCallback,\r\n    IAgentRuntime,\r\n    Memory,\r\n    Plugin,\r\n    State,\r\n} from \"@ai16z/eliza\";\r\nimport { generateWebSearch } from \"@ai16z/eliza\";\r\n\r\nimport { SearchResult } from \"@ai16z/eliza\";\r\n\r\nconst webSearch: Action = {\r\n    name: \"WEB_SEARCH\",\r\n    similes: [\r\n        \"SEARCH_WEB\",\r\n        \"INTERNET_SEARCH\",\r\n        \"LOOKUP\",\r\n        \"QUERY_WEB\",\r\n        \"FIND_ONLINE\",\r\n        \"SEARCH_ENGINE\",\r\n        \"WEB_LOOKUP\",\r\n        \"ONLINE_SEARCH\",\r\n        \"FIND_INFORMATION\",\r\n    ],\r\n    description:\r\n        \"Perform a web search to find information related to the message.\",\r\n    validate: async (runtime: IAgentRuntime, message: Memory) => {\r\n        const tavilyApiKeyOk = !!runtime.getSetting(\"TAVILY_API_KEY\");\r\n\r\n        return tavilyApiKeyOk;\r\n    },\r\n    handler: async (\r\n        runtime: IAgentRuntime,\r\n        message: Memory,\r\n        state: State,\r\n        options: any,\r\n        callback: HandlerCallback\r\n    ) => {\r\n        elizaLogger.log(\"Composing state for message:\", message);\r\n        state = (await runtime.composeState(message)) as State;\r\n        const userId = runtime.agentId;\r\n        elizaLogger.log(\"User ID:\", userId);\r\n\r\n        const webSearchPrompt = message.content.text;\r\n        elizaLogger.log(\"web search prompt received:\", webSearchPrompt);\r\n\r\n        elizaLogger.log(\"Generating image with prompt:\", webSearchPrompt);\r\n        const searchResponse = await generateWebSearch(\r\n            webSearchPrompt,\r\n            runtime\r\n        );\r\n\r\n        if (searchResponse && searchResponse.results.length) {\r\n            const responseList = searchResponse.answer\r\n                ? `${searchResponse.answer}${\r\n                      Array.isArray(searchResponse.results) &&\r\n                      searchResponse.results.length > 0\r\n                          ? `\\n\\nFor more details, you can check out these resources:\\n${searchResponse.results\r\n                                .map(\r\n                                    (result: SearchResult, index: number) =>\r\n                                        `${index + 1}. [${result.title}](${result.url})`\r\n                                )\r\n                                .join(\"\\n\")}`\r\n                          : \"\"\r\n                  }`\r\n                : \"\";\r\n\r\n            callback({\r\n                text: responseList,\r\n            });\r\n        } else {\r\n            elizaLogger.error(\"search failed or returned no data.\");\r\n        }\r\n    },\r\n    examples: [\r\n        [\r\n            {\r\n                user: \"{{user1}}\",\r\n                content: {\r\n                    text: \"Find the latest news about SpaceX launches.\",\r\n                },\r\n            },\r\n            {\r\n                user: \"{{agentName}}\",\r\n                content: {\r\n                    text: \"Here is the latest news about SpaceX launches:\",\r\n                    action: \"WEB_SEARCH\",\r\n                },\r\n            },\r\n        ],\r\n        [\r\n            {\r\n                user: \"{{user1}}\",\r\n                content: {\r\n                    text: \"Can you find details about the iPhone 16 release?\",\r\n                },\r\n            },\r\n            {\r\n                user: \"{{agentName}}\",\r\n                content: {\r\n                    text: \"Here are the details I found about the iPhone 16 release:\",\r\n                    action: \"WEB_SEARCH\",\r\n                },\r\n            },\r\n        ],\r\n        [\r\n            {\r\n                user: \"{{user1}}\",\r\n                content: {\r\n                    text: \"What is the schedule for the next FIFA World Cup?\",\r\n                },\r\n            },\r\n            {\r\n                user: \"{{agentName}}\",\r\n                content: {\r\n                    text: \"Here is the schedule for the next FIFA World Cup:\",\r\n                    action: \"WEB_SEARCH\",\r\n                },\r\n            },\r\n        ],\r\n        [\r\n            {\r\n                user: \"{{user1}}\",\r\n                content: { text: \"Check the latest stock price of Tesla.\" },\r\n            },\r\n            {\r\n                user: \"{{agentName}}\",\r\n                content: {\r\n                    text: \"Here is the latest stock price of Tesla I found:\",\r\n                    action: \"WEB_SEARCH\",\r\n                },\r\n            },\r\n        ],\r\n        [\r\n            {\r\n                user: \"{{user1}}\",\r\n                content: {\r\n                    text: \"What are the current trending movies in the US?\",\r\n                },\r\n            },\r\n            {\r\n                user: \"{{agentName}}\",\r\n                content: {\r\n                    text: \"Here are the current trending movies in the US:\",\r\n                    action: \"WEB_SEARCH\",\r\n                },\r\n            },\r\n        ],\r\n        [\r\n            {\r\n                user: \"{{user1}}\",\r\n                content: {\r\n                    text: \"What is the latest score in the NBA finals?\",\r\n                },\r\n            },\r\n            {\r\n                user: \"{{agentName}}\",\r\n                content: {\r\n                    text: \"Here is the latest score from the NBA finals:\",\r\n                    action: \"WEB_SEARCH\",\r\n                },\r\n            },\r\n        ],\r\n        [\r\n            {\r\n                user: \"{{user1}}\",\r\n                content: { text: \"When is the next Apple keynote event?\" },\r\n            },\r\n            {\r\n                user: \"{{agentName}}\",\r\n                content: {\r\n                    text: \"Here is the information about the next Apple keynote event:\",\r\n                    action: \"WEB_SEARCH\",\r\n                },\r\n            },\r\n        ],\r\n    ],\r\n} as Action;\r\n\r\nexport const webSearchPlugin: Plugin = {\r\n    name: \"webSearch\",\r\n    description: \"Search web\",\r\n    actions: [webSearch],\r\n    evaluators: [],\r\n    providers: [],\r\n};\r\n"],"mappings":"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","names":[]}